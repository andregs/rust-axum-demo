apiVersion: skaffold/v2beta28
kind: Config
metadata:
  name: axum-demo
requires:
- path: ../rust-builder
build:
  artifacts:
  - image: andregs/axum-demo
    context: ..
    requires:
    - image: andregs/rust-builder
      alias: BASE
    docker:
      dockerfile: ./axum-demo/Dockerfile
      cacheFrom:
      - andregs/rust-builder
deploy:
  kustomize:
    paths:
    - ./k8s/default
profiles:
- name: cloud
  deploy:
    kustomize:
      paths:
      - ./k8s/cloud
portForward:
- resourceType: service
  resourceName: axum-demo
  port: 3000
